# ğŸ“š JavaScript - Promise, Fetch API, Async/Await ì •ë¦¬

---

## âœ… 1. Promise ê¸°ë³¸ ê°œë…

### ğŸ”¹ ì •ì˜

ë¹„ë™ê¸° ì‘ì—…ì˜ ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ë¥¼ í‘œí˜„í•˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ê°ì²´

### ğŸ”¹ ì£¼ìš” ë©”ì„œë“œ ë° ì„¤ëª…

| ë©”ì„œë“œ                     | ì„¤ëª…                                               |
| ----------------------- | ------------------------------------------------ |
| `new Promise(executor)` | `resolve`, `reject` í•¨ìˆ˜ë¥¼ ë§¤ê°œë¡œ ë°›ì•„ ì‹¤í–‰ë˜ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ ê°ì²´ ìƒì„± |
| `.then()`               | ì„±ê³µ ì‹œ ì‹¤í–‰í•  ì½œë°±ì„ ì—°ê²°                                  |
| `.catch()`              | ì‹¤íŒ¨ ì‹œ ì‹¤í–‰í•  ì½œë°±ì„ ì—°ê²°                                  |
| `.finally()`            | ì„±ê³µì´ë“  ì‹¤íŒ¨ë“  í•­ìƒ ì‹¤í–‰ë˜ëŠ” ì½œë°± ì—°ê²°                           |

### ğŸ”¹ ì˜ˆì‹œ ì½”ë“œ (3ë‹¨ê³„ ì²´ì´ë‹)

```js
// í”„ë¡œë¯¸ìŠ¤ë¥¼ ìœ„í•œ ì‹¤í–‰ê¸° ì •ì˜
function executor(resolve, reject) { // ì•½ì†ì„ ì´í–‰í•˜ê¸° ìœ„í•œ í•¨ìˆ˜
    // resolve : ì•½ì†ì´ ì´í–‰ë˜ì—ˆì„ ë•Œ ì‹¤í–‰í•  ì½œë°±
    // reject : ì•½ì†ì´ ê±°ë¶€ë˜ì—ˆì„ ë•Œ ì‹¤í–‰í•  ì½œë°±
    const flag = true;
    if (flag) {
        resolve('ì•¼í˜¸ ì‹ ë‚œë‹¤ ! ê¹€ì¹˜ì°Œê°œ ëƒ ëƒ ');
    } else {
        reject('ì‹¤íŒ¨ ! ì£¼ë°©ì— ë¶ˆì´ ë‚¬ì–´ìš” !');
    }
}

// í”„ë¡œë¯¸ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•
// (ë¹„ë™ê¸° í†µì‹ ì„ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê³ ì í•˜ë‚˜, ì½œë°±ì§€ì˜¥ì´ ë§Œë“¤ì–´ ì§€ëŠ” ê±¸ í•´ê²°)
const myPromise1 = new Promise(executor); // ì²«ë²ˆì§¸ ì‘ì—…

// ë‘ë²ˆì§¸ ì‘ì—…: ì²«ë²ˆì§¸ ì‘ì—…ì—ì„œ ì„±ê³µ ë©”ì„¸ì§€ë¥¼ ë°›ì•„ì„œ ê·¸ ë©”ì„¸ì§€ì— ì¶”ê°€ ë©”ì„¸ì§€ë¥¼ ë” í•´ì„œ ì¶œë ¥í•˜ê³  ì‹¶ìŒ!
const myPromise2 = myPromise1.then((x) => {  // ì²«ë²ˆì§¸ ì‘ì—…ì—ì„œ ì´ì–´ì„œ ì§„í–‰ // then : ê·¸ëŸ¬ë©´
    const result = x + ' ê³„ì‚°ì€ ì–´ë””ì„œ í•˜ì£  ??';
    return new Promise((resolve, reject) => {
        resolve(result); // ì„±ê³µí–ˆì„ ë•Œ ì‹¤í–‰í•  ì½œë°±
    });
});

// ì„¸ë²ˆì§¸ ì‘ì—…: ë‘ë²ˆì§¸ ì‘ì—…ì—ì„œ ë‚˜ì˜¨ ë©”ì„¸ì§€ë¥¼ ì´ì–´ ë°›ì•„ ì‘ì—…
const myPromise3 = myPromise2.then((message) => {
    console.log(message);
})
```

---

## âœ… 2. XMLHttpRequest + Promise (ì½œë°± ì§€ì˜¥ í•´ê²°)

### ğŸ”¹ ì»¤ìŠ¤í…€ fetch í•¨ìˆ˜ `fetchGet()` ì •ì˜

```js
// XMLHttpRequestë¥¼ Promiseë¡œ ë˜í•‘í•œ í•¨ìˆ˜ ì •ì˜
function fetchGet(url) {
    return new Promise((resolve, reject) => {

        const xhr = new XMLHttpRequest();
        xhr.open('GET', url); // ìš”ì²­ ì„¸íŒ…
        xhr.send(); // ìš”ì²­ ë³´ë‚´ê¸°

        // ì‘ë‹µ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        xhr.addEventListener('load', e => {
            const responseData = JSON.parse(xhr.responseText);
            resolve(responseData);
        });

        // ì„œë²„ ì—ëŸ¬ì‹œ ë°œë™í•˜ëŠ” ì´ë²¤íŠ¸
        xhr.addEventListener('error', e => {
            reject('ì„œë²„ í†µì‹  ì¤‘ ì—ëŸ¬ ë°œìƒ!');
        });

    });
}
```

### ğŸ”¹ ì‹¤ì „ ì˜ˆì œ: ì‚¬ìš©ì â†’ ê²Œì‹œë¬¼ â†’ ëŒ“ê¸€ ìˆœì„œë¡œ ìš”ì²­

```js
// fetchGet() ì²´ì´ë‹ ë°©ì‹ìœ¼ë¡œ ì½œë°±ì§€ì˜¥ í•´ê²°
$fetchBtn.addEventListener('click', e => {
    fetchGet(`${serverUrl}/users`)
        .then((userList) => fetchGet(`${serverUrl}/posts?userId=${userList[1].id}`))
        .then((postList) => fetchGet(`${serverUrl}/comments?postId=${postList[3].id}`))
        .then((commentList) => {
            console.log(commentList);
            commentList.forEach(comment => {
                const $div = document.createElement('div');
                $div.textContent = comment.name;
                document.body.append($div);
            });
        });
});
```

---

## âœ… 3. Fetch API ê¸°ë³¸

### ğŸ”¹ ê¸°ë³¸ ì‚¬ìš©ë²•

```js
// fetchëŠ” ê¸°ë³¸ì ìœ¼ë¡œ GET ìš”ì²­ì„ ë³´ëƒ„
fetch('https://jsonplaceholder.typicode.com/posts')
    .then(res => res.json()) // ì‘ë‹µì„ JSONìœ¼ë¡œ ë³€í™˜
    .then(posts => {
        // ì„±ê³µí–ˆì„ ë•Œ ì‹¤í–‰
        displayPosts(posts.slice(0, 5)); // ìƒìœ„ 5ê°œì˜ ê²Œì‹œë¬¼ë§Œ í‘œì‹œ
    })
    .catch(error => {
        // ì‹¤íŒ¨í–ˆì„ ë•Œë§Œ ì‹¤í–‰
        postsContainer.innerHTML = `<p style="color: red;">${error}</p>`;
    })
    .finally(() => {
        // ì„±ê³µí•´ë„ ì‹¤í–‰, ì‹¤íŒ¨í•´ë„ ì‹¤í–‰
        console.log("ë°ì´í„° ìš”ì²­ ì™„ë£Œ");
    });
```

### ğŸ”¹ POST ìš”ì²­ ì˜ˆì‹œ (Gemini API í˜¸ì¶œ)

```js
const payload = {
    'contents': [
        {
            'parts': [
                {
                    'text': 'ì˜¤ëŠ˜ì˜ ë‚ ì”¨ëŠ” ì–´ë–¨ê¹Œ? ì €ë… 6ì‹œ ë‚ ì”¨ ì•Œì•„ì™€ë´'
                }
            ]
        }
    ]
};
fetch(url, {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify(payload)
})
    .then(res => res.json())
    .then(result => {
        const responseText = result.candidates[0].content.parts[0].text;
        document.body.innerHTML = `
        <div style="width: 40%; font-size: 3rem; margin: auto;">
        ${responseText}</div>`;
    });
```

---

## âœ… 4. Async / Await ë¬¸ë²•

### ğŸ”¹ ê¸°ë³¸ êµ¬ì¡°

```js
// async await ìœ¼ë¡œ fetch ì½”ë“œ ê°„ì†Œí™”
async function fetchGetAsync() {
    const res = await fetch(url); // ì‘ë‹µ ëŒ€ê¸°
    const userList = await res.json(); // JSON íŒŒì‹± ëŒ€ê¸°
    console.log(userList);
}
```

### ğŸ”¹ ë²„íŠ¼ í´ë¦­ ì‹œ ë¹„ë™ê¸° í˜¸ì¶œ

```js
const $btn = document.getElementById('btn');
$btn.addEventListener('click', e => {
    fetchGetAsync();
});
```

---

## âœ… 5. ì‹¤ì „ ì˜ˆì œ: ê²Œì‹œë¬¼ ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

### ğŸ”¹ Async / Await ì‚¬ìš©

```js
// ê²Œì‹œë¬¼ì„ í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
function displayPosts(posts) {
    const postsContainer = document.getElementById("posts");
    postsContainer.innerHTML = ""; // ê¸°ì¡´ ì½˜í…ì¸  ì´ˆê¸°í™”

    posts.forEach(post => {
        const postElement = document.createElement("div");
        postElement.classList.add("post");

        postElement.innerHTML = `
        <div class="post-title">${post.title}</div>
        <div class="post-body">${post.body}</div>
        `;

        postsContainer.append(postElement);
    });
}

// ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ ì˜¤ëŠ” í•¨ìˆ˜
async function fetchPosts() {
    // ë¡œë”© ì¤‘ ë©”ì‹œì§€ í‘œì‹œ
    const postsContainer = document.getElementById("posts");
    postsContainer.innerHTML = "<p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>";

    try {
        const res = await fetch("https://jsonplaceholder.typicode.com/posts");
        const posts = await res.json();
        displayPosts(posts.slice(0, 5)); // ìƒìœ„ 5ê°œì˜ ê²Œì‹œë¬¼ë§Œ í‘œì‹œ
    } catch (error) {
        postsContainer.innerHTML = `<p style="color: red;">${error}</p>`;
    } finally {
        // ì„±ê³µí•´ë„ ì‹¤í–‰, ì‹¤íŒ¨í•´ë„ ì‹¤í–‰
        console.log("ë°ì´í„° ìš”ì²­ ì™„ë£Œ");
    }
}

// ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
document.getElementById("fetchPosts").addEventListener("click", () => {
    fetchPosts();
});
```

---

## âœ… ì‚¬ìš© ì •ë¦¬ í‘œ

| êµ¬ë¶„          | ë¬¸ë²•                                        | ì„¤ëª…                   |
| ----------- | ----------------------------------------- | -------------------- |
| Promise     | `new Promise((resolve, reject) => {...})` | ë¹„ë™ê¸° ì²˜ë¦¬ ê°ì²´ ìƒì„±         |
| then        | `promise.then(result => {...})`           | ì„±ê³µ ì‹œ ì‹¤í–‰ë  ì½”ë“œ ë“±ë¡       |
| catch       | `promise.catch(error => {...})`           | ì‹¤íŒ¨ ì‹œ ì‹¤í–‰ë  ì½”ë“œ ë“±ë¡       |
| finally     | `promise.finally(() => {...})`            | ì„±ê³µ/ì‹¤íŒ¨ì™€ ìƒê´€ì—†ì´ í•­ìƒ ì‹¤í–‰    |
| fetch       | `fetch(url)`                              | HTTP ìš”ì²­ ë³´ë‚´ê¸° (ê¸°ë³¸ GET) |
| async/await | `async function`, `await`                 | ë™ê¸°ì‹ì²˜ëŸ¼ ë¹„ë™ê¸° ì½”ë“œ ì‘ì„±      |

---

