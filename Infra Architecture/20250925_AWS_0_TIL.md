# AWS EC2:  네트워크, 보안 및 구매 옵션

## 4강 - 탄력적 IP와 보안 그룹

### Elastic Network Interface (ENI)

가상 네트워크 인터페이스로, EC2 인스턴스가 네트워크와 통신할 수 있도록 하는 핵심 요소입니다.

-   각 ENI는 **IP 주소**, **MAC 주소** 등을 부여받습니다.
-   인스턴스 생성 시, 기본 ENI가 자동으로 생성되어 IP 주소 등의 정보를 할당받습니다.
-   하나의 EC2 인스턴스에 여러 개의 ENI를 추가로 연결하여 멀티-홈(multi-homed) 네트워크 구성을 할 수 있습니다.

---

### Public IP vs. Private IP

-   **퍼블릭 IP (Public IP)**: 인터넷과 직접 통신할 때 사용하는 외부 IP 주소입니다.
-   **프라이빗 IP (Private IP)**: VPC(가상 프라이빗 클라우드)와 같은 내부 네트워크에서만 사용하는 IP 주소입니다. 인터넷 게이트웨이(Internet Gateway)를 통해서만 외부 인터넷과 통신할 수 있습니다.

---

### 탄력적 IP (Elastic IP)

**고정된(정적인) 퍼블릭 IP 주소**입니다. EC2 인스턴스를 중지했다가 다시 시작해도 IP 주소가 변경되지 않도록 보장합니다.

-   **문제점**: 기본적으로 EC2 인스턴스에 할당되는 퍼블릭 IP는 '동적'입니다. 인스턴스를 재시작하면 IP 주소가 변경될 수 있습니다.
-   **해결책**: 탄력적 IP를 발급받아 인스턴스의 ENI에 연결하면, 해당 인스턴스는 고유한 고정 IP를 갖게 되어 외부에서 항상 동일한 주소로 접속할 수 있습니다.
-   ⚠️ **주의**: 사용하지 않는 탄력적 IP에는 비용이 청구됩니다.

#### 🚨 탄력적 IP 과금 주의사항

탄력적 IP는 특정 조건 하에서 시간당 `$0.005`의 요금이 부과됩니다.

-   **과금 조건**:
    -   탄력적 IP를 발급만 받고 EC2 인스턴스에 연결하지 않은 경우
    -   탄력적 IP가 연결된 EC2 인스턴스가 '중지' 상태인 경우

-   **흔한 과금 시나리오**:
    1.  EC2 인스턴스를 삭제(Terminate)합니다.
    2.  인스턴스에 연결되어 있던 탄력적 IP를 해제(Release)하는 것을 잊습니다.
    3.  연결되지 않은 탄력적 IP가 계정에 남아있어 계속 과금됩니다.

-   **해결 방법 (탄력적 IP 반납)**:
    1.  `탄력적 IP` 메뉴로 이동합니다.
    2.  반납할 IP를 선택합니다.
    3.  `작업` -> `탄력적 IP 주소 연결 해제`를 클릭하여 인스턴스와의 연결을 끊습니다.
    4.  다시 `작업` -> `탄력적 IP 주소 릴리스`를 클릭하여 IP를 완전히 반납합니다.

---

### 보안 그룹 (Security Group)

EC2 인스턴스로 들어오고 나가는 트래픽을 제어하는 **가상 방화벽**입니다. 인스턴스의 ENI에 적용됩니다.

-   **특징**:
    -   **허용(Allow) 규칙만** 설정할 수 있습니다. (거부 규칙 없음)
    -   상태 저장(Stateful) 방화벽: 인바운드 규칙에 의해 허용된 트래픽의 응답은 아웃바운드 규칙과 상관없이 자동으로 허용됩니다.

-   **트래픽 종류**:
    -   **인바운드(Inbound)**: 외부에서 인스턴스로 들어오는 트래픽. (기본적으로 **모두 차단**)
    -   **아웃바운드(Outbound)**: 인스턴스에서 외부로 나가는 트래픽. (기본적으로 **모두 허용**)

-   **제어 규칙 요소**:
    -   **유형**: 트래픽의 종류 (예: SSH, HTTP, HTTPS, RDP 등)
    -   **프로토콜**: 통신 규약 (예: TCP, UDP, ICMP 등)
    -   **포트 범위**: 서비스 포트 번호 (예: 22, 80, 443, 3389 등)
    -   **소스/대상**: 트래픽을 허용할 IP 주소(CIDR 형식), 또는 다른 보안 그룹 ID

<br>

## 5강 - 인스턴스 구매 옵션

다양한 워크로드와 예산에 맞춰 EC2 인스턴스를 유연하게 구매할 수 있는 여러 옵션을 제공합니다.

### 인스턴스 구매 옵션 요약

-   **온디맨드 (On-Demand)**: 약정 없이 사용한 만큼 초 단위로 비용을 지불합니다.
-   **스팟 (Spot)**: AWS의 남는 용량을 경매 방식으로 저렴하게 구매하지만, 중단될 수 있습니다.
-   **예약 인스턴스 (Reserved Instance)**: 1년 또는 3년 약정을 통해 큰 폭의 할인을 받습니다.
-   **Saving Plans**: 1년 또는 3년 약정을 통해 시간당 특정 사용량에 대해 할인을 받으며, 예약 인스턴스보다 유연합니다.
-   **전용 호스트/인스턴스 (Dedicated)**: 다른 테넌트와 분리된 전용 물리 서버를 할당받습니다.

---

### 온디맨드 인스턴스 (On-Demand Instance)

-   **개념**: 약정이나 선결제 없이, 사용한 컴퓨팅 파워에 대해 초 단위로 비용을 지불하는 가장 기본적인 방식입니다.
-   **장점**:
    -   장기 계약의 부담이 없습니다.
    -   필요할 때 언제든 생성하고 삭제할 수 있어 유연성이 높습니다.
-   **적합한 사용 사례**:
    -   수요 예측이 불가능한 단기 워크로드
    -   절대 중단되어서는 안 되는 애플리케이션
    -   개발 및 테스트 환경

---

### 예약 인스턴스 (Reserved Instance, RI)

-   **개념**: 1년 또는 3년의 사용 기간을 약정하여 온디맨드 요금 대비 **최대 75%**의 높은 할인율을 제공받는 방식입니다.
-   **장점**:
    -   예측 가능한 꾸준한 워크로드에 대해 비용을 크게 절감할 수 있습니다.
-   **결제 옵션**:
    -   전체 선결제 (All Upfront)
    -   부분 선결제 (Partial Upfront)
    -   선결제 없음 (No Upfront)
-   **RI 유형**:

| 유형                           | 설명                                                                                             | 특징 및 용도                                                                |
| ------------------------------ | ------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------- |
| **표준 (Standard)** | 약정 기간 동안 인스턴스 패밀리, 타입 등 속성을 변경할 수 없습니다.                                 | 가장 높은 할인율을 제공하며, 워크로드가 완전히 고정적일 때 적합합니다.        |
| **전환형 (Convertible)** | 약정 기간 중 인스턴스 패밀리, OS 등 다른 속성의 RI로 교환할 수 있습니다.                           | 표준 RI보다 할인율은 낮지만 유연성이 높습니다.                              |
| **정기 (Scheduled)** | 지정된 시간(매일, 매주, 매월)에 반복적으로 인스턴스를 예약하여 사용합니다.                         | 특정 시간대에만 필요한 배치 작업이나 분석 작업에 유용합니다.                |

---

### Saving Plans

-   **개념**: 1년 또는 3년 기간 동안 특정 사용량(시간당 USD 요금)을 약정하고 온디맨드 대비 **최대 72%** 할인을 받는 유연한 요금 모델입니다.
-   **장점**:
    -   **높은 유연성**: 리전, 인스턴스 패밀리, OS에 상관없이 약정한 금액 내에서 할인이 자동으로 적용됩니다.
    -   **적용 범위**: EC2 뿐만 아니라 **AWS Lambda, AWS Fargate**에도 적용됩니다.
-   **작동 방식**: 시간당 $10를 약정했다면, 컴퓨팅 사용량이 $10에 도달할 때까지 할인된 요금이 적용되고, 초과분은 온디맨드 요금으로 청구됩니다.
-   **유형**: Compute Saving Plans, EC2 Instance Saving Plans 두 가지가 있습니다.

---

### 전용 호스트 / 전용 인스턴스

-   **개념**: 다른 AWS 고객과 하드웨어를 공유하지 않는, 사용자 전용 물리 서버를 할당받는 방식입니다. 규정 준수 또는 라이선스 요구사항을 충족하기 위해 사용됩니다.
-   **전용 호스트 (Dedicated Host)**:
    -   물리 서버 전체를 제어하며, CPU 소켓, 코어 등의 가시성을 확보합니다.
    -   인스턴스 배치 위치를 직접 제어할 수 있습니다.
    -   기존에 보유한 소켓/코어 기반의 소프트웨어 라이선스(BYOL)를 사용할 수 있습니다.
-   **전용 인스턴스 (Dedicated Instance)**:
    -   전용 하드웨어에서 인스턴스가 실행되지만, 호스트 수준의 제어(인스턴스 배치 등)는 불가능합니다.

---

### 스팟 인스턴스 (Spot Instance)

-   **개념**: AWS 데이터 센터의 사용되지 않는 예비 EC2 용량을 경매 방식으로 구매하여 사용하는 방식입니다. 온디맨드 대비 **최대 90%** 저렴합니다.
-   **핵심 특징**:
    -   **중단 가능성**: 사용자가 제시한 가격보다 스팟 가격이 높아지면 인스턴스가 2분의 경고 후 **종료되거나 중지**될 수 있습니다.
-   **적합한 사용 사례**:
    -   언제든 중단되어도 괜찮은 내결함성(fault-tolerant) 워크로드 (예: 빅데이터 분석, 배치 처리, CI/CD)
    -   서버가 지속적으로 실행될 필요가 없는 경우
-   **활용**:
    -   **스팟 집합 (Spot Fleets)**: 여러 스팟 인스턴스를 하나의 그룹으로 묶어 관리할 수 있습니다.
    -   **하이브리드 사용**: 안정성이 필요한 부분은 예약 인스턴스로, 갑작스러운 트래픽 증가는 스팟 인스턴스로 처리하여 비용 효율을 극대화할 수 있습니다.

---

### 인스턴스 유형 (Instance Types)

-   **개념**: 인스턴스를 생성할 때 선택하는 하드웨어 사양의 조합입니다.
-   **구성 요소**: CPU, 메모리, 스토리지, 네트워킹 용량의 다양한 조합으로 구성됩니다.
-   **인스턴스 패밀리**: 워크로드의 목적에 따라 최적화된 유형으로 분류됩니다.
    -   **범용 (General Purpose)**
    -   **컴퓨팅 최적화 (Compute Optimized)**
    -   **메모리 최적화 (Memory Optimized)**
    -   **가속화된 컴퓨팅 (Accelerated Computing)**
    -   **스토리지 최적화 (Storage Optimized)**
